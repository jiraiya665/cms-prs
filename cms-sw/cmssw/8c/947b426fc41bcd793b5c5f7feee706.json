{"additions": 160, "auther_ref": "cleanup11_0_0_pre4", "auther_sha": "19e52473db1e35d0adca93ccaddb356e4a25a0c4", "author": "mariadalfonso", "body": "This PR save 10% of the CPU speed in view of the Run3.\r\nNo changes are expected in the E/ArrivalTime of recHits.\r\nPass clang formats checks.\r\n\r\nMain gain is in the updatePulseShape and updateCov functions of Mahi.\r\nBelow igprof report.\r\n\r\nORIGINAL:\r\n```\r\n           13.4  .........      62.43 / 63.03        MahiFit::phase1Apply(HBHEChannelInfo const&, float&, float&, bool&, float&) const [45]\r\n[46]       13.4      62.43       3.03 / 59.40      MahiFit::doFit(std::array<float, 3ul>&, int) const\r\n            9.7  .........      45.45 / 45.45        MahiFit::minimize() const [47]\r\n            1.7  .........       7.75 / 7.75         MahiFit::updatePulseShape(double, Eigen::Matrix<double, -1, 1, 0, 19, 1>&, Eigen::Matrix<double, -1, 1, 0, 19, 1>&, Eigen::Matrix<$\r\n            1.3  .........       6.19 / 6.19         MahiFit::calculateArrivalTime() const [80]\r\n            0.0  .........       0.00 / 0.89         _init [204]\r\n            0.0  .........       0.00 / 0.12         _dl_runtime_resolve_xsave [757]\r\n\r\n- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\r\n            9.7  .........      45.45 / 62.43        MahiFit::doFit(std::array<float, 3ul>&, int) const [46]\r\n[47]        9.7      45.45       0.52 / 44.92      MahiFit::minimize() const\r\n            4.2  .........      19.42 / 19.42        MahiFit::nnls() const [53]\r\n            3.5  .........      16.26 / 16.26        MahiFit::updateCov() const [55]\r\n            1.2  .........       5.54 / 5.54         MahiFit::onePulseMinimize() const [83]\r\n            0.8  .........       3.63 / 3.63         MahiFit::calculateChiSq() const [94]\r\n            0.0  .........       0.07 / 0.89         _init [204]\r\n```\r\n\r\nNEW\r\n\r\n```\r\n           11.0  .........      57.34 / 57.54        MahiFit::phase1Apply(HBHEChannelInfo const&, float&, float&, bool&, float&) const [45]\r\n[46]       11.0      57.34       3.78 / 53.55      MahiFit::doFit(std::array<float, 3ul>&, int) const\r\n            8.1  .........      42.62 / 42.62        MahiFit::minimize() const [47]\r\n            1.1  .........       5.76 / 5.76         MahiFit::updatePulseShape(double, Eigen::Matrix<double, -1, 1, 0, 19, 1>&, Eigen::Matrix<double, -1, 1, 0, 19, 1>&, Eigen::Matrix<$\r\nle, -1, -1, 0, 19, 19>&) const [78]\r\n            1.0  .........       5.17 / 5.17         MahiFit::calculateArrivalTime() const [81]\r\n            0.0  .........       0.00 / 0.79         _init [211]\r\n\r\n- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\r\n            8.1  .........      42.62 / 57.34        MahiFit::doFit(std::array<float, 3ul>&, int) const [46]\r\n[47]        8.1      42.62       0.32 / 42.29      MahiFit::minimize() const\r\n            4.6  .........      24.09 / 24.09        MahiFit::nnls() const [48]\r\n            2.1  .........      10.73 / 10.73        MahiFit::updateCov() const [60]\r\n            0.9  .........       4.65 / 4.65         MahiFit::onePulseMinimize() const [85]\r\n            0.5  .........       2.80 / 2.80         MahiFit::calculateChiSq() const [107]\r\n            0.0  .........       0.02 / 0.79         _init [211]\r\n\r\n```\r\n\r\n\r\n\r\n\r\n", "branch": "master", "changed_files": 8, "comments": 1, "commits": 1, "created_at": "1565260198", "deletions": 135, "labels": ["code-checks-pending", "comparison-pending", "orp-pending", "pending-signatures", "reconstruction-pending", "tests-pending"], "milestone": "CMSSW_11_0_X", "number": 27726, "release-notes": [], "review_comments": 0, "state": "open", "title": "HBHE cleanup and speedup", "updated_at": "1565260252", "user": "mariadalfonso"}