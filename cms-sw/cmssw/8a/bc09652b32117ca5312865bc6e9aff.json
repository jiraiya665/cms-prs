{"additions": 110, "auther_ref": "from-CMSSW_11_0_X_2019-11-01-2300_MAHI", "auther_sha": "daaf0e050c793989b49ef202ad7cad5335860cff", "author": "mariadalfonso", "body": "This PR gain 20% in CPU speed up in the minimize function see igprof results below.\r\n\r\nTo keep in mind for the future:\r\n1) the fit can be moved from double to float \r\nhttp://dalfonso.web.cern.ch/dalfonso/HCAL/HCAL_PR28366.pdf\r\nImpact on the INtime energy is negligible\r\n2) the maxSV size should be moved 10 -->8 once the 2018menu is removed.\r\n\r\n-- release  --\r\n\r\n```\r\n- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\r\n           82.3  .........      54.85 / 55.09        MahiFit::phase1Apply(HBHEChannelInfo const&, float&, float&, bool&, float&) const [18]\r\n[19]       82.3      54.85       2.92 / 51.93      MahiFit::doFit(std::array<float, 3ul>&, int) const\r\n           60.8  .........      40.54 / 40.54        MahiFit::minimize() const [20]\r\n            9.4  .........       6.26 / 6.26         MahiFit::calculateArrivalTime() const [25]\r\n            7.5  .........       5.03 / 5.03         MahiFit::updatePulseShape(double, Eigen::Matrix<double, -1, 1, 0, 19, 1>&, Eigen::Matrix<double, -1, 1, 0, 19, 1>&, Eigen::Matrix<double, -1, -1, $\r\nnst [28]\r\n\r\n- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\r\n           60.8  .........      40.54 / 54.85        MahiFit::doFit(std::array<float, 3ul>&, int) const [19]\r\n[20]       60.8      40.54       0.39 / 40.15      MahiFit::minimize() const\r\n           31.7  .........      21.15 / 21.15        MahiFit::nnls() const [21]\r\n           15.8  .........      10.56 / 10.56        MahiFit::updateCov() const [23]\r\n            7.7  .........       5.14 / 5.14         MahiFit::onePulseMinimize() const [27]\r\n            4.9  .........       3.26 / 3.26         MahiFit::calculateChiSq() const [33]\r\n```\r\n \r\n\r\n-- this PR at commit 0ac75e6   --\r\n\r\n```\r\n- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\r\n           80.0  .........      46.86 / 47.15        MahiFit::phase1Apply(HBHEChannelInfo const&, float&, float&, bool&, float&) const [18]\r\n[19]       80.0      46.86       2.30 / 44.56      MahiFit::doFit(std::array<float, 3ul>&, int) const\r\n           57.5  .........      33.71 / 33.71        MahiFit::minimize() const [20]\r\n           10.5  .........       6.15 / 6.15         MahiFit::updatePulseShape(float, Eigen::Matrix<float, -1, 1, 0, 15, 1>&, Eigen::Matrix<float, -1, 1, 0, 15,1>&, Eigen::Matrix<float, -1, -1, 0, 15, 15>&) const [25]\r\n            8.0  .........       4.67 / 4.67         MahiFit::calculateArrivalTime(unsigned int) const [27]\r\n\r\n\r\n- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\r\n           57.5  .........      33.71 / 46.86        MahiFit::doFit(std::array<float, 3ul>&, int) const [19]\r\n[20]       57.5      33.71       0.51 / 33.19      MahiFit::minimize() const\r\n           29.4  .........      17.20 / 17.20        MahiFit::nnls() const [21]\r\n           16.3  .........       9.54 / 9.54         MahiFit::updateCov(Eigen::Matrix<float, -1, -1, 0, 10, 10> const&) const [22]\r\n            6.0  .........       3.49 / 3.49         MahiFit::onePulseMinimize() const [31]\r\n            5.0  .........       2.93 / 2.93         MahiFit::calculateChiSq() const [34]\r\n\r\n\r\n```\r\n", "branch": "master", "changed_files": 8, "comments": 54, "commits": 11, "created_at": "1573205022", "deletions": 113, "labels": ["code-checks-approved", "comparison-available", "orp-pending", "pending-signatures", "reconstruction-pending", "tests-approved"], "milestone": "CMSSW_11_0_X", "number": 28366, "release-notes": [], "review_comments": 12, "state": "open", "title": "HBHE: speed up + mahi move double to float", "updated_at": "1573688847", "user": "mariadalfonso"}