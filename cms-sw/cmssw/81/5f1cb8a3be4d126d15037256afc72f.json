{"additions": 58, "auther_ref": "PluginLoadError", "auther_sha": "54661f306157c2504ee364a3ab8beae4d88774fa", "author": "guitargeek", "body": "#### PR description:\r\n\r\nThe error message that you get if you delete plugin that is in the realease in your work area, and then try to use that plugin, is not very informative. The way this is handled is by referring to \"poisoned\" libraries in the work area, which actually don't exist. So you get some error like this:\r\n\r\n```\r\nunable to load /scratch/rembser/cmssw/dev/CMSSW_11_0_X_2019-08-30-0100/lib/slc7_amd64_gcc700/poisoned/plugin-poisoned-RecoEgammaElectronIdentificationPlugins.so because /scratch/rembser/cmssw/dev/CMSSW_11_0_X_2019-08-30-0100/lib/slc7_amd64_gcc700/poisoned/plugin-poisoned-RecoEgammaElectronIdentificationPlugins.so: cannot open shared object file: No such file or directory\r\n```\r\n\r\nHowever, it would be great (in particular to catch mistakes in cleanup PRs) if the message told you the name of the plugin it tried to load in the first place. I propose a mechanism to do so, I hope the implementation is ok. The error message would look like this then:\r\n\r\n```\r\ncould not load plugin ElectronMVANtuplizer because unable to load /scratch/rembser/cmssw/dev/CMSSW_11_0_X_2019-08-30-0100/lib/slc7_amd64_gcc700/poisoned/plugin-poisoned-RecoEgammaElectronIdentificationPlugins.so because /scratch/rembser/cmssw/dev/CMSSW_11_0_X_2019-08-30-0100/lib/slc7_amd64_gcc700/poisoned/plugin-poisoned-RecoEgammaElectronIdentificationPlugins.so: cannot open shared object file: No such file or directory\r\n```\r\n\r\nWe talked a bit about this already a little bit in PR https://github.com/cms-sw/cmssw/pull/27522 (in particular https://github.com/cms-sw/cmssw/pull/27522#issuecomment-516534785).\r\n\r\nWhile investigating how to do that I \"git grepped\" for \"SharedLibrary\" and therefore found by chance many places where `SharedLibrary.h` is included but not used. We could also remove these as a little side effect of this PR.\r\n\r\n#### PR validation:\r\n\r\nCMSSW compiles, local matrix tests pass.\r\n\r\n#### if this PR is a backport please specify the original PR:\r\n\r\nNo backport intended.\r\n", "branch": "master", "changed_files": 17, "comments": 13, "commits": 3, "created_at": "1567235211", "deletions": 80, "labels": ["code-checks-approved", "comparison-available", "core-pending", "db-approved", "orp-pending", "pending-signatures", "tests-approved"], "milestone": "CMSSW_11_0_X", "number": 27908, "release-notes": [], "review_comments": 0, "state": "open", "title": "More verbose error if plugin could not be loaded due to missing shared library", "updated_at": "1567508006", "user": "guitargeek"}