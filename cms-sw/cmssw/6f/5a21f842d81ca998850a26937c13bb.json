{"additions": 18, "auther_ref": "dqm-fix-deadlock-in-setbinlabel", "auther_sha": "e2a99653941515483776a7ea2d7bad68d5f806f1", "author": "schneiml", "body": "#### PR description:\r\n\r\nFixes the IB test failure in 136.8861 (and maybe others). The deadlock was triggered by `LogMessageMonitor:ClusterizerLogMessageMonCommon` in `bookHistograms`. Reported in #28622.\r\n\r\nThis one only triggers in the error path, because getFullname tries to\r\ntake a lock that we already hold.\r\n\r\nHowever, there is another opportunity for a deadlock via edm::Log*\r\n(which probably takes a lock), and the per ME-locks which could be taken\r\nbefore or after edm::Log* is called. I reviewed all usages of edm::Log*\r\nin DQMServices/Core and did not see anything problematic.\r\n\r\nNote that this is the only usage of edm::Log* in MonitorElement, and it\r\nnow avoids taking multiple locks at the same time, so there should not\r\nbe any more problems of this type.\r\n\r\n#### PR validation:\r\n Runs 136.8861 without deadlock.", "branch": "master", "changed_files": 1, "comments": 12, "commits": 1, "created_at": "1581415841", "deletions": 12, "labels": ["code-checks-approved", "comparison-notrun", "dqm-pending", "orp-pending", "pending-signatures", "tests-rejected"], "milestone": "CMSSW_11_1_X", "number": 28916, "release-notes": [], "review_comments": 0, "state": "open", "title": "DQM: Fix potential deadlock in setBinLabel.", "updated_at": "1581432364", "user": "schneiml"}